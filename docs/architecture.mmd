```mermaid
flowchart TD
  U[User] -->|Sign in| WEB[Next.js 15 App (Vercel)]
  WEB -->|OpenID 2.0 redirect + verify| STEAMOID[Steam OpenID]
  WEB -->|GetOwnedGames include_appinfo=1| STEAMAPI[Steam Web API]
  WEB -->|appdetails price estimate| STEAMSTORE[Steam Store API (estimate)]

  WEB --> DB[(Supabase Postgres)]
  WEB --> PAY[Stripe Checkout + Webhooks]
  WEB --> EMAIL[Resend/Postmark]
  WEB --> GEMINI[Gemini API]

  subgraph SWARM[Gemini Workflow Runner]
    QUEUE[Claim Job Queue]
    RUNNER[Step Runner]
    SCRAPE[Scraper Step]
    LEGAL[Legal Mapping Step]
    DRAFT[Letter Drafting Step]
    FILE[Filing Packet Step]
    QUEUE --> RUNNER --> SCRAPE --> LEGAL --> DRAFT --> FILE
  end

  WEB -->|enqueue job| QUEUE
  SCRAPE -->|Playwright| BROWSER[Web scraping]
  SCRAPE -->|Serper/Tavily| SEARCH[Search API]
  LEGAL -->|structured prompts| GEMINI
  DRAFT -->|structured prompts| GEMINI
  FILE -->|structured prompts| GEMINI
  LEGAL -->|EU/UK law corpus| LAW[(Law text store)]
  DRAFT -->|PDF renderer| PDF[PDF Generator]
  FILE -->|Form templates| FORMS[(Jurisdiction templates)]

  RUNNER -->|progress + artifacts| DB
  PDF --> DB
  WEB -->|progress UI| U
```
